<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Lab06 - Review of Encryption Algorithms</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      href="{{ url_for('static', filename='images/uit_logo.png') }}"
    />
    <link
      rel="shortcut icon"
      type="image/png"
      href="{{ url_for('static', filename='images/uit_logo.png') }}"
    />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Poppins:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Custom CSS -->
    <link
      href="{{ url_for('static', filename='css/style.css') }}"
      rel="stylesheet"
    />
    <!-- Force file button hover fix -->
    <style>
      input[type="file"]::file-selector-button:hover,
      input[type="file"]::-webkit-file-upload-button:hover {
        background-color: #2563eb !important;
        color: #ffffff !important;
        transform: translateY(-2px) scale(1.02) !important;
        box-shadow: 0 4px 8px rgba(37, 99, 235, 0.3) !important;
      }
    </style>
  </head>

  <body>
    <!-- GitHub Link Button -->
    <a
      href="https://github.com/daithang59/Lab06-AnToanMangMayTinh"
      target="_blank"
      rel="noopener noreferrer"
      class="github-link"
      aria-label="View on GitHub"
      title="View on GitHub"
    >
      <i class="bi bi-github"></i>
    </a>

    <!-- Theme Toggle Button -->
    <button
      class="theme-toggle"
      id="theme-toggle"
      aria-label="Toggle Dark Mode"
    >
      <!-- Sun Icon -->
      <svg
        class="sun-icon"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        style="display: none"
      >
        <path
          d="M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1s-1 .45-1 1v1c0 .55.45 1 1 1zm0 19c.55 0 1-.45 1-1v-1c0-.55-.45-1-1-1s-1 .45-1 1v1c0 .55.45 1 1 1zm9-10c0 .55-.45 1-1 1h-1c-.55 0-1-.45-1-1s.45-1 1-1h1c.55 0 1 .45 1 1zm-18 0c0 .55-.45 1-1 1H2c-.55 0-1-.45-1-1s.45-1 1-1h1c.55 0 1 .45 1 1zm15.95 6.05c.39.39.39 1.02 0 1.41-.39.39-1.02.39-1.41 0l-.71-.71c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0l.71.71zM6.17 5.05c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-.71.71c-.39.39-1.02.39-1.41 0-.39-.39-.39-1.02 0-1.41l.71-.71zM17.83 5.05l.71.71c.39.39.39 1.02 0 1.41-.39.39-1.02.39-1.41 0l-.71-.71c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0zM5.05 17.83l.71.71c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41l-.71-.71c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41z"
        />
      </svg>
      <!-- Moon Icon -->
      <svg
        class="moon-icon"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
      >
        <path
          d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-3.03 0-5.5-2.47-5.5-5.5 0-1.82.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"
        />
      </svg>
    </button>

    <!-- Keyboard Shortcuts Hint -->
    <div class="keyboard-hint" id="keyboard-hint">
      üí° <strong>Shortcuts:</strong> <kbd>Ctrl</kbd>+<kbd>Enter</kbd> Submit |
      <kbd>Ctrl</kbd>+<kbd>D</kbd> Dark Mode | <kbd>Ctrl</kbd>+<kbd>K</kbd>
      Upload File
    </div>

    <div class="container py-4">
      <!-- Header with Logo -->
      <div class="text-center mb-4">
        <div class="d-flex justify-content-center align-items-center mb-3">
          <a
            href="https://www.uit.edu.vn"
            target="_blank"
            rel="noopener noreferrer"
            title="Visit UIT Website"
          >
            <img
              src="{{ url_for('static', filename='images/uit_logo.png') }}"
              alt="UIT Logo"
              class="uit-logo me-3"
              style="
                height: 100px;
                width: auto;
                object-fit: contain;
                cursor: pointer;
              "
            />
          </a>
          <h1 class="mb-0 fw-bold">Lab06 ‚Äì Review of Encryption Algorithms</h1>
        </div>
        <p class="text-muted" style="font-size: 1.1rem">
          MSSV: 23521422 - Hu·ª≥nh L√™ ƒê·∫°i Th·∫Øng - UIT
        </p>
      </div>

      <!-- LAYOUT: VERTICAL TABS (LEFT) + CONTENT (RIGHT) -->
      <div class="row">
        <!-- LEFT COLUMN: NAVIGATION -->
        <div class="col-md-3 mb-4">
          <ul class="nav nav-pills flex-column" id="pills-tab">
            <li class="nav-item">
              <button
                class="nav-link {% if active_tab=='task1' or not active_tab %}active{% endif %} w-100 text-start"
                data-bs-toggle="pill"
                data-bs-target="#task1"
              >
                Task 1 ‚Äì Caesar
              </button>
            </li>
            <li class="nav-item">
              <button
                class="nav-link {% if active_tab=='task2' %}active{% endif %} w-100 text-start"
                data-bs-toggle="pill"
                data-bs-target="#task2"
              >
                Task 2 ‚Äì Substitution
              </button>
            </li>
            <li class="nav-item">
              <button
                class="nav-link {% if active_tab=='task3' %}active{% endif %} w-100 text-start"
                data-bs-toggle="pill"
                data-bs-target="#task3"
              >
                Task 3 ‚Äì Vigen√®re
              </button>
            </li>
            <li class="nav-item">
              <button
                class="nav-link {% if active_tab=='task4' %}active{% endif %} w-100 text-start"
                data-bs-toggle="pill"
                data-bs-target="#task4"
              >
                Task 4 ‚Äì DES
              </button>
            </li>
            <li class="nav-item">
              <button
                class="nav-link {% if active_tab=='task5' %}active{% endif %} w-100 text-start"
                data-bs-toggle="pill"
                data-bs-target="#task5"
              >
                Task 5 ‚Äì AES
              </button>
            </li>
          </ul>
        </div>

        <!-- RIGHT COLUMN: CONTENT -->
        <div class="col-md-9">
          <div class="tab-content">
            <!-- ============================
             TASK 1 ‚Äì CAESAR
             ============================ -->
            <div
              class="tab-pane fade {% if active_tab=='task1' or not active_tab %}show active{% endif %}"
              id="task1"
            >
              <div class="card shadow-sm">
                <div class="card-body">
                  <h4 class="card-title fw-bold">Task 1 ‚Äì Caesar Cipher</h4>
                  <p class="text-muted">
                    Upload ciphertext (ti·∫øng Anh, ƒë√£ m√£ h√≥a Caesar). H·ªá th·ªëng s·∫Ω
                    brute-force 26 kh√≥a v√† ch·ªçn plaintext gi·ªëng ti·∫øng Anh nh·∫•t.
                  </p>

                  <form
                    method="POST"
                    action="{{ url_for('task1_caesar') }}"
                    enctype="multipart/form-data"
                    id="task1-form"
                  >
                    <!-- Input Method Selection -->
                    <div class="mb-4">
                      <label class="form-label fw-semibold"
                        >Ph∆∞∆°ng th·ª©c nh·∫≠p li·ªáu</label
                      >
                      <div class="selection-card-group">
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="file"
                            id="task1-input-file"
                            checked
                          />
                          <label for="task1-input-file">
                            <i class="bi bi-file-earmark-arrow-up"></i>
                            <span>Upload file</span>
                          </label>
                        </div>
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="text"
                            id="task1-input-text"
                          />
                          <label for="task1-input-text">
                            <i class="bi bi-keyboard"></i>
                            <span>Nh·∫≠p text tr·ª±c ti·∫øp</span>
                          </label>
                        </div>
                      </div>
                    </div>

                    <!-- File Input Section -->
                    <div class="mb-3" id="task1-file-section">
                      <label class="form-label fw-semibold"
                        >Ciphertext file (.txt)</label
                      >
                      <input
                        type="file"
                        name="cipher_file"
                        class="form-control"
                        id="task1-file-input"
                        accept=".txt"
                      />
                    </div>

                    <!-- Text Input Section -->
                    <div
                      class="mb-3"
                      id="task1-text-section"
                      style="display: none"
                    >
                      <label class="form-label fw-semibold"
                        >Nh·∫≠p ciphertext tr·ª±c ti·∫øp</label
                      >
                      <textarea
                        name="cipher_text"
                        class="form-control"
                        rows="4"
                        id="task1-text-input"
                        placeholder="Nh·∫≠p ciphertext c·∫ßn gi·∫£i m√£..."
                      ></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary px-4">
                      <i class="bi bi-play-circle"></i> Decrypt
                    </button>
                  </form>

                  {% if task1_result %}
                  <hr />
                  <p><strong>Detected Key:</strong> {{ task1_key }}</p>
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <label class="form-label fw-semibold mb-0"
                      >Plaintext:</label
                    >
                    <button
                      type="button"
                      class="btn btn-sm btn-outline-primary"
                      onclick="copyToClipboard('task1-output', this)"
                    >
                      <i class="bi bi-clipboard"></i> Copy
                    </button>
                  </div>
                  <textarea
                    id="task1-output"
                    class="form-control"
                    rows="10"
                    readonly
                  >
{{ task1_result }}</textarea
                  >
                  {% endif %}
                </div>
              </div>
            </div>

            <!-- ============================
             TASK 2 ‚Äì SUBSTITUTION
             ============================ -->
            <div
              class="tab-pane fade {% if active_tab=='task2' %}show active{% endif %}"
              id="task2"
            >
              <div class="card shadow-sm">
                <div class="card-body">
                  <h4 class="card-title fw-bold">
                    Task 2 ‚Äì Monoalphabetic Substitution Cipher
                  </h4>
                  <p class="text-muted">
                    Upload ciphertext d√πng monoalphabetic substitution (ch·ªâ ch·ªØ
                    c√°i a‚Äìz ƒë∆∞·ª£c thay th·∫ø). H·ªá th·ªëng d√πng hill-climbing ƒë·ªÉ t√¨m
                    mapping t·ªët nh·∫•t.
                  </p>

                  <form
                    method="POST"
                    action="{{ url_for('task2_substitution') }}"
                    enctype="multipart/form-data"
                    id="task2-form"
                  >
                    <!-- Input Method Selection -->
                    <div class="mb-4">
                      <label class="form-label fw-semibold"
                        >Ph∆∞∆°ng th·ª©c nh·∫≠p li·ªáu</label
                      >
                      <div class="selection-card-group">
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="file"
                            id="task2-input-file"
                            checked
                          />
                          <label for="task2-input-file">
                            <i class="bi bi-file-earmark-arrow-up"></i>
                            <span>Upload file</span>
                          </label>
                        </div>
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="text"
                            id="task2-input-text"
                          />
                          <label for="task2-input-text">
                            <i class="bi bi-keyboard"></i>
                            <span>Nh·∫≠p text tr·ª±c ti·∫øp</span>
                          </label>
                        </div>
                      </div>
                    </div>

                    <!-- File Input Section -->
                    <div class="mb-3" id="task2-file-section">
                      <label class="form-label fw-semibold"
                        >Ciphertext file (.txt)</label
                      >
                      <input
                        type="file"
                        name="cipher_file"
                        class="form-control"
                        id="task2-file-input"
                        accept=".txt"
                      />
                    </div>

                    <!-- Text Input Section -->
                    <div
                      class="mb-3"
                      id="task2-text-section"
                      style="display: none"
                    >
                      <label class="form-label fw-semibold"
                        >Nh·∫≠p ciphertext tr·ª±c ti·∫øp</label
                      >
                      <textarea
                        name="cipher_text"
                        class="form-control"
                        rows="4"
                        id="task2-text-input"
                        placeholder="Nh·∫≠p ciphertext c·∫ßn crack..."
                      ></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary px-4">
                      <i class="bi bi-play-circle"></i> Crack Cipher
                    </button>
                  </form>

                  {% if task2_result %}
                  <hr />
                  <p><strong>Score:</strong> {{ task2_score }}</p>
                  <p><strong>Mapping:</strong> {{ task2_mapping }}</p>
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <label class="form-label fw-semibold mb-0"
                      >Plaintext:</label
                    >
                    <button
                      type="button"
                      class="btn btn-sm btn-outline-primary"
                      onclick="copyToClipboard('task2-output', this)"
                    >
                      <i class="bi bi-clipboard"></i> Copy
                    </button>
                  </div>
                  <textarea
                    id="task2-output"
                    class="form-control"
                    rows="10"
                    readonly
                  >
{{ task2_result }}</textarea
                  >
                  {% endif %}
                </div>
              </div>
            </div>

            <!-- ============================
             TASK 3 ‚Äì VIGENERE
             ============================ -->
            <div
              class="tab-pane fade {% if active_tab=='task3' %}show active{% endif %}"
              id="task3"
            >
              <div class="card shadow-sm">
                <div class="card-body">
                  <h4 class="card-title fw-bold">
                    Task 3 ‚Äì Vigen√®re Cipher (Key Unknown)
                  </h4>
                  <p class="text-muted">
                    Upload ciphertext Vigen√®re (kh√¥ng bi·∫øt kh√≥a). H·ªá th·ªëng ∆∞·ªõc
                    l∆∞·ª£ng ƒë·ªô d√†i kh√≥a b·∫±ng Index of Coincidence, sau ƒë√≥ t√¨m t·ª´ng
                    k√Ω t·ª± kh√≥a b·∫±ng ph√¢n t√≠ch t·∫ßn su·∫•t.
                  </p>

                  <form
                    method="POST"
                    action="{{ url_for('task3_vigenere') }}"
                    enctype="multipart/form-data"
                    id="task3-form"
                  >
                    <!-- Input Method Selection -->
                    <div class="mb-4">
                      <label class="form-label fw-semibold"
                        >Ph∆∞∆°ng th·ª©c nh·∫≠p li·ªáu</label
                      >
                      <div class="selection-card-group">
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="file"
                            id="task3-input-file"
                            checked
                          />
                          <label for="task3-input-file">
                            <i class="bi bi-file-earmark-arrow-up"></i>
                            <span>Upload file</span>
                          </label>
                        </div>
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="text"
                            id="task3-input-text"
                          />
                          <label for="task3-input-text">
                            <i class="bi bi-keyboard"></i>
                            <span>Nh·∫≠p text tr·ª±c ti·∫øp</span>
                          </label>
                        </div>
                      </div>
                    </div>

                    <!-- File Input Section -->
                    <div class="mb-3" id="task3-file-section">
                      <label class="form-label fw-semibold"
                        >Ciphertext file (.txt)</label
                      >
                      <input
                        type="file"
                        name="cipher_file"
                        class="form-control"
                        id="task3-file-input"
                        accept=".txt"
                      />
                    </div>

                    <!-- Text Input Section -->
                    <div
                      class="mb-3"
                      id="task3-text-section"
                      style="display: none"
                    >
                      <label class="form-label fw-semibold"
                        >Nh·∫≠p ciphertext tr·ª±c ti·∫øp</label
                      >
                      <textarea
                        name="cipher_text"
                        class="form-control"
                        rows="4"
                        id="task3-text-input"
                        placeholder="Nh·∫≠p Vigen√®re ciphertext..."
                      ></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary px-4">
                      <i class="bi bi-play-circle"></i> Break Cipher
                    </button>
                  </form>

                  {% if task3_result %}
                  <hr />
                  <p class="fw-semibold">
                    <span class="text-primary">Recovered Key:</span>
                    <span class="ms-2">{{ task3_key }}</span>
                  </p>
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <label class="form-label fw-semibold mb-0"
                      >Plaintext:</label
                    >
                    <button
                      type="button"
                      class="btn btn-sm btn-outline-primary"
                      onclick="copyToClipboard('task3-output', this)"
                    >
                      <i class="bi bi-clipboard"></i> Copy
                    </button>
                  </div>
                  <textarea
                    id="task3-output"
                    class="form-control"
                    rows="10"
                    readonly
                  >
{{ task3_result }}</textarea
                  >
                  {% endif %}
                </div>
              </div>
            </div>

            <!-- ============================
             TASK 4 ‚Äì DES
             ============================ -->
            <div
              class="tab-pane fade {% if active_tab=='task4' %}show active{% endif %}"
              id="task4"
            >
              <div class="card shadow-sm">
                <div class="card-body">
                  <h4 class="card-title fw-bold">
                    Task 4 ‚Äì DES Encryption/Decryption
                  </h4>
                  <p class="text-muted">
                    Th·ª±c hi·ªán m√£ h√≥a/gi·∫£i m√£ DES v·ªõi 2 mode (ECB, CBC). D·ªØ li·ªáu
                    input & output ƒë·ªÅu ·ªü d·∫°ng hex.
                  </p>

                  <form
                    method="POST"
                    action="{{ url_for('task4_des') }}"
                    enctype="multipart/form-data"
                    id="task4-form"
                  >
                    <!-- Format Information Alert -->
                    <div class="alert alert-info" role="alert">
                      <h6 class="alert-heading">
                        <i class="bi bi-info-circle-fill"></i> üìñ ƒê·ªãnh d·∫°ng
                        Input/Output
                      </h6>
                      <small>
                        <strong>Encrypt:</strong> Input = plaintext (UTF-8) ‚Üí
                        Output = ciphertext (hex)<br />
                        <strong>Decrypt:</strong> Input = ciphertext (hex) ‚Üí
                        Output = plaintext (UTF-8)<br />
                        <strong>M·∫∑c ƒë·ªãnh:</strong> Ciphertext s·ª≠ d·ª•ng
                        <strong>Hexadecimal format</strong> (backend c≈©ng h·ªó tr·ª£
                        Base64)
                      </small>
                    </div>

                    <!-- Action Selection -->
                    <div class="mb-4">
                      <label class="form-label fw-semibold">Ch·ªçn ch·∫ø ƒë·ªô</label>
                      <div class="selection-card-group">
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="action"
                            value="encrypt"
                            id="task4-action-encrypt"
                            checked
                          />
                          <label for="task4-action-encrypt">
                            <i class="bi bi-shield-lock"></i>
                            <span>Encrypt</span>
                          </label>
                        </div>
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="action"
                            value="decrypt"
                            id="task4-action-decrypt"
                          />
                          <label for="task4-action-decrypt">
                            <i class="bi bi-shield-check"></i>
                            <span>Decrypt</span>
                          </label>
                        </div>
                      </div>
                      <div class="form-text mt-2" id="task4-action-hint">
                        M√£ h√≥a d·ªØ li·ªáu b√¨nh th∆∞·ªùng th√†nh hex
                      </div>
                    </div>

                    <!-- Input Method Selection -->
                    <div class="mb-4">
                      <label class="form-label fw-semibold"
                        >Ph∆∞∆°ng th·ª©c nh·∫≠p li·ªáu</label
                      >
                      <div class="selection-card-group">
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="file"
                            id="task4-input-file"
                            checked
                          />
                          <label for="task4-input-file">
                            <i class="bi bi-file-earmark-arrow-up"></i>
                            <span>Upload file</span>
                          </label>
                        </div>
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="text"
                            id="task4-input-text"
                          />
                          <label for="task4-input-text">
                            <i class="bi bi-keyboard"></i>
                            <span>Nh·∫≠p text tr·ª±c ti·∫øp</span>
                          </label>
                        </div>
                      </div>
                    </div>

                    <!-- File Input Section -->
                    <div class="mb-3" id="task4-file-section">
                      <label class="form-label fw-semibold">Ch·ªçn file</label>
                      <input
                        type="file"
                        name="input_file"
                        class="form-control"
                        id="task4-file-input"
                        accept=".txt"
                      />
                      <div class="form-text" id="task4-file-hint">
                        File ch·ª©a d·ªØ li·ªáu plaintext c·∫ßn m√£ h√≥a
                      </div>
                    </div>

                    <!-- Text Input Section -->
                    <div
                      class="mb-3"
                      id="task4-text-section"
                      style="display: none"
                    >
                      <label class="form-label fw-semibold"
                        >Nh·∫≠p d·ªØ li·ªáu tr·ª±c ti·∫øp</label
                      >
                      <textarea
                        name="plaintext_input"
                        class="form-control"
                        rows="4"
                        id="task4-text-input"
                        placeholder="Nh·∫≠p plaintext ho·∫∑c hex..."
                      ></textarea>
                      <div class="form-text" id="task4-text-hint">
                        Nh·∫≠p text b√¨nh th∆∞·ªùng ƒë·ªÉ m√£ h√≥a
                      </div>
                    </div>

                    <!-- Mode and Key Settings -->
                    <div class="row">
                      <div class="col-md-6 mb-3">
                        <label class="form-label fw-semibold">Mode</label>
                        <select class="form-select" name="mode" required>
                          <option value="ECB">ECB</option>
                          <option value="CBC">CBC</option>
                        </select>
                      </div>

                      <div class="col-md-6 mb-3">
                        <label class="form-label fw-semibold"
                          >Key (hex, 16 chars)
                          <i
                            class="bi bi-info-circle"
                            data-bs-toggle="tooltip"
                            data-bs-placement="top"
                            title="DES s·ª≠ d·ª•ng kh√≥a 8 bytes (64 bit). Nh·∫≠p 16 k√Ω t·ª± hex (0-9, A-F). V√≠ d·ª•: 0123456789ABCDEF"
                          ></i>
                        </label>
                        <input
                          type="text"
                          name="key"
                          class="form-control"
                          placeholder="0123456789ABCDEF"
                          required
                        />
                        <div class="form-text">
                          üîë <strong>DES Key:</strong> 8 bytes = 16 hex chars.
                          Ch·ªâ ch·∫•p nh·∫≠n 0-9, A-F (case-insensitive). <br />üí°
                          <em>M·∫∑c ƒë·ªãnh output format: Hexadecimal</em>
                        </div>
                      </div>
                    </div>

                    <!-- IV for CBC -->
                    <div class="mb-3">
                      <label class="form-label fw-semibold"
                        >IV (hex, 16 chars - ch·ªâ cho CBC)
                        <i
                          class="bi bi-info-circle"
                          data-bs-toggle="tooltip"
                          data-bs-placement="top"
                          title="Initialization Vector cho CBC mode. ECB kh√¥ng c·∫ßn IV. CBC encrypt c√≥ th·ªÉ ƒë·ªÉ tr·ªëng (auto-generate), CBC decrypt ph·∫£i nh·∫≠p."
                        ></i>
                      </label>
                      <input
                        type="text"
                        name="iv"
                        class="form-control"
                        placeholder="ƒê·ªÉ tr·ªëng n·∫øu d√πng ECB ho·∫∑c t·ª± sinh IV"
                      />
                      <div class="form-text">
                        üîê <strong>IV:</strong> 8 bytes = 16 hex chars cho DES.
                        <br />‚Ä¢ <strong>ECB mode:</strong> Kh√¥ng c·∫ßn IV (ƒë·ªÉ
                        tr·ªëng) <br />‚Ä¢ <strong>CBC Encrypt:</strong> ƒê·ªÉ tr·ªëng s·∫Ω
                        t·ª± ƒë·ªông sinh IV ng·∫´u nhi√™n <br />‚Ä¢
                        <strong>CBC Decrypt:</strong> B·∫Øt bu·ªôc nh·∫≠p IV t·ª´ l√∫c
                        encrypt
                      </div>
                    </div>

                    <button type="submit" class="btn btn-primary px-4">
                      <i class="bi bi-play-circle"></i> Th·ª±c hi·ªán
                    </button>
                  </form>

                  {% if task4_result %}
                  <hr />
                  {% if task4_iv %}
                  <div class="mb-3">
                    <div
                      class="d-flex justify-content-between align-items-center mb-2"
                    >
                      <label class="form-label fw-semibold mb-0"
                        >IV Used:</label
                      >
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                        onclick="copyToClipboard('task4-iv-output', this)"
                      >
                        <i class="bi bi-clipboard"></i> Copy IV
                      </button>
                    </div>
                    <input
                      type="text"
                      id="task4-iv-output"
                      class="form-control"
                      value="{{ task4_iv }}"
                      readonly
                    />
                  </div>
                  {% endif %}
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <label class="form-label fw-semibold mb-0"
                      >Output (hex):</label
                    >
                    <button
                      type="button"
                      class="btn btn-sm btn-outline-primary"
                      onclick="copyToClipboard('task4-output', this)"
                    >
                      <i class="bi bi-clipboard"></i> Copy
                    </button>
                  </div>
                  <textarea
                    id="task4-output"
                    class="form-control"
                    rows="10"
                    readonly
                  >
{{ task4_result }}</textarea
                  >
                  {% endif %}
                </div>
              </div>
            </div>

            <!-- ============================
             TASK 5 ‚Äì AES
             ============================ -->
            <div
              class="tab-pane fade {% if active_tab=='task5' %}show active{% endif %}"
              id="task5"
            >
              <div class="card shadow-sm">
                <div class="card-body">
                  <h4 class="card-title fw-bold">
                    Task 5 ‚Äì AES Encryption/Decryption
                  </h4>
                  <p class="text-muted">
                    Th·ª±c hi·ªán m√£ h√≥a/gi·∫£i m√£ AES-128 v·ªõi mode ECB/CBC.
                  </p>

                  <form
                    id="task5-form"
                    method="POST"
                    action="{{ url_for('task5_aes') }}"
                    enctype="multipart/form-data"
                  >
                    <!-- Format Information Alert -->
                    <div class="alert alert-info" role="alert">
                      <h6 class="alert-heading">
                        <i class="bi bi-info-circle-fill"></i> üìñ ƒê·ªãnh d·∫°ng
                        Input/Output
                      </h6>
                      <small>
                        <strong>Encrypt:</strong> Input = plaintext (UTF-8) ‚Üí
                        Output = ciphertext (hex)<br />
                        <strong>Decrypt:</strong> Input = ciphertext (hex) ‚Üí
                        Output = plaintext (UTF-8)<br />
                        <strong>M·∫∑c ƒë·ªãnh:</strong> AES-128 v·ªõi
                        <strong>Hexadecimal format</strong>. Backend h·ªó tr·ª£
                        AES-192/256 v√† Base64.<br />
                        <strong>Padding:</strong> PKCS#7 (t·ª± ƒë·ªông x·ª≠ l√Ω)
                      </small>
                    </div>

                    <!-- Action Selection -->
                    <div class="mb-4">
                      <label class="form-label fw-semibold">Ch·ªçn ch·∫ø ƒë·ªô</label>
                      <div class="selection-card-group">
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="action"
                            value="encrypt"
                            id="task5-action-encrypt"
                            checked
                          />
                          <label for="task5-action-encrypt">
                            <i class="bi bi-shield-lock"></i>
                            <span>Encrypt</span>
                          </label>
                        </div>
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="action"
                            value="decrypt"
                            id="task5-action-decrypt"
                          />
                          <label for="task5-action-decrypt">
                            <i class="bi bi-shield-check"></i>
                            <span>Decrypt</span>
                          </label>
                        </div>
                      </div>
                      <div class="form-text mt-2" id="task5-action-hint">
                        M√£ h√≥a d·ªØ li·ªáu b√¨nh th∆∞·ªùng th√†nh hex
                      </div>
                    </div>

                    <!-- Input Method Selection -->
                    <div class="mb-4">
                      <label class="form-label fw-semibold"
                        >Ph∆∞∆°ng th·ª©c nh·∫≠p li·ªáu</label
                      >
                      <div class="selection-card-group">
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="file"
                            id="task5-input-file"
                            checked
                          />
                          <label for="task5-input-file">
                            <i class="bi bi-file-earmark-arrow-up"></i>
                            <span>Upload file</span>
                          </label>
                        </div>
                        <div class="selection-card">
                          <input
                            type="radio"
                            name="input_method"
                            value="text"
                            id="task5-input-text"
                          />
                          <label for="task5-input-text">
                            <i class="bi bi-keyboard"></i>
                            <span>Nh·∫≠p text tr·ª±c ti·∫øp</span>
                          </label>
                        </div>
                      </div>
                    </div>

                    <!-- File Input Section -->
                    <div class="mb-3" id="task5-file-section">
                      <label class="form-label fw-semibold">Ch·ªçn file</label>
                      <input
                        type="file"
                        name="input_file"
                        class="form-control"
                        id="task5-file-input"
                        accept=".txt"
                      />
                      <div class="form-text" id="task5-file-hint">
                        File ch·ª©a d·ªØ li·ªáu plaintext c·∫ßn m√£ h√≥a
                      </div>
                    </div>

                    <!-- Text Input Section -->
                    <div
                      class="mb-3"
                      id="task5-text-section"
                      style="display: none"
                    >
                      <label class="form-label fw-semibold"
                        >Nh·∫≠p d·ªØ li·ªáu tr·ª±c ti·∫øp</label
                      >
                      <textarea
                        name="plaintext_input"
                        class="form-control"
                        rows="4"
                        id="task5-text-input"
                        placeholder="Nh·∫≠p plaintext ho·∫∑c hex..."
                      ></textarea>
                      <div class="form-text" id="task5-text-hint">
                        Nh·∫≠p text b√¨nh th∆∞·ªùng ƒë·ªÉ m√£ h√≥a
                      </div>
                    </div>

                    <!-- Mode and Key Settings -->
                    <div class="row">
                      <div class="col-md-4 mb-3">
                        <label class="form-label fw-semibold"
                          >AES Key Size</label
                        >
                        <select
                          class="form-select"
                          id="task5-key-size"
                          name="key_size"
                          required
                        >
                          <option value="128" selected>AES-128 (32 hex)</option>
                          <option value="192">AES-192 (48 hex)</option>
                          <option value="256">AES-256 (64 hex)</option>
                        </select>
                        <div class="form-text">Ch·ªçn ƒë·ªô d√†i kh√≥a AES</div>
                      </div>

                      <div class="col-md-4 mb-3">
                        <label class="form-label fw-semibold">Mode</label>
                        <select class="form-select" name="mode" required>
                          <option value="ECB">ECB</option>
                          <option value="CBC">CBC</option>
                        </select>
                      </div>

                      <div class="col-md-4 mb-3">
                        <label class="form-label fw-semibold"
                          >Key (hex)
                          <i
                            class="bi bi-info-circle"
                            data-bs-toggle="tooltip"
                            data-bs-placement="top"
                            title="ƒê·ªô d√†i key ph·ª• thu·ªôc v√†o AES key size ƒë√£ ch·ªçn: 128-bit=32 hex, 192-bit=48 hex, 256-bit=64 hex"
                          ></i>
                        </label>
                        <input
                          type="text"
                          name="key"
                          id="task5-key-input"
                          class="form-control"
                          placeholder="2B7E151628AED2A6ABF7158809CF4F3C"
                          required
                        />
                        <div class="form-text" id="task5-key-hint">
                          üîë <strong>AES-128:</strong> 32 hex chars (16 bytes)
                        </div>
                      </div>
                    </div>

                    <!-- IV for CBC -->
                    <div class="mb-3">
                      <label class="form-label fw-semibold"
                        >IV (hex, 32 chars - ch·ªâ cho CBC)
                        <i
                          class="bi bi-info-circle"
                          data-bs-toggle="tooltip"
                          data-bs-placement="top"
                          title="Initialization Vector cho CBC mode. Ph·∫£i b·∫±ng block size (16 bytes = 32 hex). ECB kh√¥ng d√πng IV."
                        ></i>
                      </label>
                      <input
                        type="text"
                        name="iv"
                        class="form-control"
                        placeholder="ƒê·ªÉ tr·ªëng n·∫øu d√πng ECB ho·∫∑c t·ª± sinh IV"
                      />
                      <div class="form-text">
                        üîê <strong>IV:</strong> 16 bytes = 32 hex chars cho AES
                        (block size 128-bit). <br />‚Ä¢
                        <strong>ECB mode:</strong> Kh√¥ng c·∫ßn IV (ƒë·ªÉ tr·ªëng)
                        <br />‚Ä¢ <strong>CBC Encrypt:</strong> ƒê·ªÉ tr·ªëng s·∫Ω t·ª±
                        ƒë·ªông sinh IV ng·∫´u nhi√™n <br />‚Ä¢
                        <strong>CBC Decrypt:</strong> B·∫Øt bu·ªôc nh·∫≠p IV t·ª´ l√∫c
                        encrypt
                      </div>
                    </div>

                    <button type="submit" class="btn btn-primary px-4">
                      <i class="bi bi-play-circle"></i> Th·ª±c hi·ªán
                    </button>
                  </form>

                  {% if task5_result %}
                  <hr />
                  {% if task5_iv %}
                  <div class="mb-3">
                    <div
                      class="d-flex justify-content-between align-items-center mb-2"
                    >
                      <label class="form-label fw-semibold mb-0"
                        >IV Used:</label
                      >
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-secondary"
                        onclick="copyToClipboard('task5-iv-output', this)"
                      >
                        <i class="bi bi-clipboard"></i> Copy IV
                      </button>
                    </div>
                    <input
                      type="text"
                      id="task5-iv-output"
                      class="form-control"
                      value="{{ task5_iv }}"
                      readonly
                    />
                  </div>
                  {% endif %}
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <label class="form-label fw-semibold mb-0"
                      >Output (hex):</label
                    >
                    <button
                      type="button"
                      class="btn btn-sm btn-outline-primary"
                      onclick="copyToClipboard('task5-output', this)"
                    >
                      <i class="bi bi-clipboard"></i> Copy
                    </button>
                  </div>
                  <textarea
                    id="task5-output"
                    class="form-control"
                    rows="10"
                    readonly
                  >
{{ task5_result }}</textarea
                  >
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
          <!-- END TAB CONTENT -->
        </div>
      </div>
    </div>
    <!-- END CONTAINER -->

    <footer class="text-center py-4 text-muted small">
      <p class="mb-1">MSSV: 23521422 - Hu·ª≥nh L√™ ƒê·∫°i Th·∫Øng - UIT</p>
      <p class="mb-2">
        &copy; 2025 Lab06 Encryption Algorithms. All rights reserved.
      </p>
      <p>
        <a
          href="https://github.com/daithang59/Lab06-AnToanMangMayTinh"
          target="_blank"
          rel="noopener noreferrer"
          class="text-decoration-none"
          style="color: #6c757d; transition: color 0.3s"
          onmouseover="this.style.color='#0d6efd'"
          onmouseout="this.style.color='#6c757d'"
        >
          <i class="bi bi-github" style="font-size: 1.5rem"></i>
          <span class="ms-2">View on GitHub</span>
        </a>
      </p>
    </footer>

    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
